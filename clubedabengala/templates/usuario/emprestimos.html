{% extends 'base.html' %}


{% block header %}
    <h1 class="my-3">{% block title %}Meus Empréstimos{% endblock %}</h1>
{% endblock %}


{% block content %}

<a role="btn" class="btn btn-secondary" href="{{ url_for('usuario.emprestimos_create', id = g.user['id']) }}">Solicitar Novo Empréstimo</a>
<div class="my-5 row">
    <table class="table">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Data Solicitado</th>
                <th scope="col">Status</th>
                <th scope="col">Beneficiário</th>
                <th scope="col">Equipamento</th>
                <th scope="col">Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for e in emprestimos %}
            <tr>
                <td>{{ e.id }}</td>
                <td>{{ e.created }}</td>
                <td>{{ e.status }}</td>
                <td>{{ e.beneficiario_name }}</td>
                <td>{{ e.equip_type_name }} {{e.equip_model_name}} {% if e.equip_size_desc %}{{e.equip_size_desc}}{% endif %}</td>
                <td>
                    <p><a href="{{ url_for('usuario.emprestimos_details', id = g.user['id'], eid = e.id) }}">Detalhes</a></p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
    // window.estado = {
    //     editing: null,

    //     resetEditing: function() {
    //         $("#name").val('');
    //         $("#dataNascimento").val('');
    //         $("#altura").val('');
    //         $("#peso").val('');
    //         $("#nrCalcado").val('');
    //         $("#beneficiario_id").val('');

    //         $('.x-edit').each(function(idx, a) {
    //             $(a).html('Editar');
    //             $(a).parent().parent().parent().removeClass('table-primary');
    //         });

    //         window.estado.editing = null;
    //     },

    //     applyMasks: function() {
    //         $("#dataNascimento").mask('00-00-0000');
    //         $("#altura").mask('0,00');
    //         $("#peso").mask('0,00');
    //         $("#nrCalcado").mask('00');
    //     }

    // };

    // $(document).ready(function() {

    //     window.estado.applyMasks();

    //     $(".x-edit").click(function(e) {
    //         e.preventDefault();

    //         let editAnother = false;
    //         if (e.target != window.estado.editing) {
    //             editAnother = true;
    //         }

    //         window.estado.resetEditing();

    //         if (editAnother) {
    //             $(this).html('Editando...');
    //             $("#name").val($(this).data('name'));
    //             $("#dataNascimento").val($(this).data('datanascimento'));
    //             $("#altura").val($(this).data('altura'));
    //             $("#peso").val($(this).data('peso'));
    //             $("#nrCalcado").val($(this).data('nrcalcado'));
    //             $("#beneficiario_id").val($(this).data('beneficiarioid'));
    //             $(this).parent().parent().parent().addClass('table-primary');
    //             window.estado.editing = e.target;
    //         }
    //     })
    // })
</script>
{% endblock%}